<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Virtual Tour â€“ Pamles Park</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

<style>
html,body{
  margin:0;
  height:100%;
  font-family:'Inter',sans-serif;
  overflow:hidden;
  background:#000;
}

a-scene{
  position:fixed;
  inset:0;
}

/* INFO */
.info{
  position:fixed;
  top:14px;
  left:14px;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(10px);
  color:#fff;
  padding:10px 14px;
  border-radius:12px;
  z-index:20;
  font-size:13px;
}

/* MINI CONTROLS */
.controls{
  position:fixed;
  right:14px;
  top:14px;
  display:flex;
  flex-direction:column;
  gap:8px;
  z-index:30;
}

.ctrl{
  width:44px;
  height:44px;
  border-radius:50%;
  background:rgba(0,0,0,.6);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
  cursor:pointer;
}

/* ROOM NAV */
.nav{
  position:fixed;
  bottom:16px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:6px;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(12px);
  padding:6px;
  border-radius:16px;
  z-index:20;
}
.nav button{
  border:none;
  padding:10px 14px;
  border-radius:12px;
  background:transparent;
  color:#fff;
  font-weight:600;
}
.nav button.active{
  background:#00c2a8;
  color:#000;
}
</style>

<script>
/* ===== UNIT ===== */
const params = new URLSearchParams(window.location.search)
const unit = params.get('unit') || 'type67'

const UNITS = {
  type67:{
    living:'type67/living.jpg',
    bedroom:'type67/bedroom.jpg',
    kitchen:'type67/kitchen.jpg'
  }
}

let current = 'living'
let gyroEnabled = false

function setScene(room){
  current = room
  document.getElementById('scene')
    .setAttribute('src','assets/sample/'+UNITS[unit][room])

  document.querySelectorAll('.nav button')
    .forEach(b=>b.classList.remove('active'))
  document.getElementById(room).classList.add('active')
}

/* ===== FULLSCREEN ===== */
function fullscreen(){
  const el = document.documentElement
  if(!document.fullscreenElement){
    el.requestFullscreen?.() || el.webkitRequestFullscreen?.()
  }else{
    document.exitFullscreen?.() || document.webkitExitFullscreen?.()
  }
}

/* ===== GYRO SAFE ENABLE ===== */
async function toggleGyro(){
  const cam = document.getElementById('cam')

  if(!gyroEnabled){
    if (
      typeof DeviceOrientationEvent !== 'undefined' &&
      typeof DeviceOrientationEvent.requestPermission === 'function'
    ) {
      const perm = await DeviceOrientationEvent.requestPermission()
      if (perm !== 'granted') return alert('Izin sensor ditolak')
    }

    cam.setAttribute('device-orientation-controls','enabled:true')
    gyroEnabled = true
  }else{
    cam.setAttribute('device-orientation-controls','enabled:false')
    gyroEnabled = false
  }
}

/* ===== BACK ===== */
function backHome(){
  location.href = 'index.html'
}
</script>
</head>

<body>

<div class="info">
  <strong>Pamles Park</strong><br>
  Virtual Tour
</div>

<!-- MINI CONTROLS -->
<div class="controls">
  <div class="ctrl" onclick="backHome()">â¬…</div>
  <div class="ctrl" onclick="toggleGyro()">ðŸ“±</div>
  <div class="ctrl" onclick="fullscreen()">â›¶</div>
</div>

<!-- ROOM NAV -->
<div class="nav">
  <button id="living" class="active" onclick="setScene('living')">Living</button>
  <button id="bedroom" onclick="setScene('bedroom')">Kamar</button>
  <button id="kitchen" onclick="setScene('kitchen')">Dapur</button>
</div>

<!-- SCENE -->
<a-scene embedded>
  <a-sky id="scene"
    src="assets/sample/type67/living.jpg"
    rotation="0 -90 0"></a-sky>

  <!-- PENTING: look-controls SELALU AKTIF -->
  <a-camera id="cam"
    look-controls="touchEnabled:true; mouseEnabled:true"
    device-orientation-controls="enabled:false"
    wasd-controls-enabled="false">
    <a-cursor></a-cursor>
  </a-camera>
</a-scene>

<script>
setScene(current)
</script>

</body>
</html>
